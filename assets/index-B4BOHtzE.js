import{d as K,i as Y,j,f as q,e as b,w as k,h as i,o as _,a,k as x,u as N,s as y,c as w,b as v,l as E,m as B,v as R,F as V,n as D}from"./index-C_5Oh6uc.js";import{w as F,c as M,E as S,T as $,S as z,b as L}from"./editable-CteuoeWb.js";import{w as P,a as U,Y as T,c as H,g as I,b as O}from"./index-BzMY5OhK.js";import{T as W}from"./Toolbar-C0OhOQAT.js";import{_ as h,a as s}from"./BlockButton.vue_vue_type_script_setup_true_lang-CHZUc-AW.js";import"./Button-ZsKZe3Ph.js";const X=K({__name:"YjsEditor",props:{sharedType:{}},setup(g){const p=[{type:"paragraph",children:[{text:""}]}],f=({attributes:e,children:t,element:c})=>{const o={...e,style:{"text-align":"align"in c?c.align||"left":""}};switch(c.type){case"block-quote":return i("blockquote",o,t);case"bulleted-list":return i("ul",o,t);case"heading-one":return i("h1",o,t);case"heading-two":return i("h2",o,t);case"heading-three":return i("h3",o,t);case"list-item":return i("li",o,t);case"numbered-list":return i("ol",o,t);default:return i("p",o,t)}},l=({leaf:e,attributes:t,children:c})=>{const o={};return"bold"in e&&(o.fontWeight="bold"),"italic"in e&&(o.fontStyle="italic"),"underline"in e&&(o.borderBottom="1px solid black"),"delete"in e&&(o.textDecoration="line-through"),i("code"in e?"code":"bold"in e?"strong":"span",{...t,style:o},c)},m=g,r=P(U(F(M()),m.sharedType));r.children=p;const{normalizeNode:d}=r;return r.normalizeNode=e=>{const[t]=e;if(!S.isEditor(t)||t.children.length>0)return d(e);$.insertNodes(r,p[0],{at:[0]})},Y(()=>{T.connect(r)}),j(()=>{T.disconnect(r)}),(e,t)=>(_(),q(b(z),{editor:b(r),"render-element":f,"render-leaf":l},{default:k(()=>[a(W,null,{default:k(()=>[a(h,{format:"bold",icon:"format_bold"}),a(h,{format:"italic",icon:"format_italic"}),a(h,{format:"underline",icon:"format_underlined"}),a(h,{format:"code",icon:"code"}),a(s,{format:"heading-one",icon:"looks_one"}),a(s,{format:"heading-two",icon:"looks_two"}),a(s,{format:"block-quote",icon:"format_quote"}),a(s,{format:"numbered-list",icon:"format_list_numbered"}),a(s,{format:"bulleted-list",icon:"format_list_bulleted"}),a(s,{format:"left",icon:"format_align_left"}),a(s,{format:"center",icon:"format_align_center"}),a(s,{format:"right",icon:"format_align_right"}),a(s,{format:"justify",icon:"format_align_justify"})]),_:1}),a(b(L),{placeholder:"Enter some rich textâ€¦",spellcheck:""})]),_:1},8,["editor"]))}}),G={style:{display:"flex",width:"100%"}},J={key:1,style:{height:"300px"}},re=K({__name:"index",setup(g){const p=N(),f=D(),l=x(p.query.publicApiKey||""),m=y(),r=y(),d=y(),e=x(!1),t=n=>e.value=n,c=()=>{try{const n=H({publicApiKey:l.value}).enterRoom("remote-simple"),u=I(n.room);u.on("sync",t),m.value=n,r.value=u,d.value=u.getYDoc().get("slate",O)}catch(n){alert(n),f.push({name:"remote-simple",query:{publicApiKey:""}})}},o=()=>{m.value?.leave(),r.value?.off("sync",t),m.value=void 0,r.value=void 0,d.value=void 0,e.value=!1,l.value=""};Y(()=>{l.value&&c()}),j(()=>{o()});const A=n=>{n.key==="Enter"&&(f.push({name:"remote-simple",query:{publicApiKey:l.value}}),c())};return(n,u)=>(_(),w(V,null,[u[1]||(u[1]=v("a",{href:"https://liveblocks.io/dashboard",style:{"margin-bottom":"12px",display:"block"},target:"_blank"}," ðŸ‘‰ Click it and get a publicApiKey from liveblocks",-1)),v("div",G,[B(v("input",{"onUpdate:modelValue":u[0]||(u[0]=C=>l.value=C),onKeyup:A,placeholder:"paste your liveblocks publicApiKey, and press Enter to connect",style:{width:"100%","margin-bottom":"10px"}},null,544),[[R,l.value]])]),d.value&&e.value?(_(),q(X,{key:0,sharedType:d.value},null,8,["sharedType"])):E("",!0),d.value&&!e.value?(_(),w("div",J,"Loading...")):E("",!0)],64))}});export{re as default};
