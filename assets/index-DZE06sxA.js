import{t as _,m as g,R as S,N as D,a as L,i as B,c as O,w as I,S as M,T as $,b as P}from"./editable-OBw7MXqz.js";import{u as U}from"./use-inherit-ref-lmEEbD6_.js";import{u as G}from"./use-focused-35x2xrHB.js";import{u as V}from"./use-selected-9MwQlhdF.js";import{d as C,o as R,c as q,g as z,b as W,z as K,e as y,f as Q,w as X,a as Y,h as u}from"./index-cO_khfoC.js";import{w as J}from"./with-history-Bo5zoz4N.js";const A=new _,F=new _;class k{}class b extends k{offset;path;constructor(t={}){super();const{offset:n,path:e}=t;this.offset=n,this.path=e}}class T extends k{offset;path;constructor(t={}){super();const{offset:n,path:e}=t;this.offset=n,this.path=e}}const Z=(r,t)=>{const n=r.text.length;A.set(r,[n,t])},ee=r=>A.get(r),te=(r,t)=>{const n=r.text.length;F.set(r,[n,t])},ne=r=>F.get(r),w=new WeakSet,E=r=>{const t=[],n=e=>{if(e==null)return;const o=t[t.length-1];if(typeof e=="string"){const c={text:e};w.add(c),e=c}if(g.isText(e)){const c=e;g.isText(o)&&w.has(o)&&w.has(c)&&g.equals(o,c,{loose:!0})?o.text+=c.text:t.push(c)}else if(L.isElement(e))t.push(e);else if(e instanceof k){let c=t[t.length-1];g.isText(c)||(n(""),c=t[t.length-1]),e instanceof b?Z(c,e):e instanceof T&&te(c,e)}else throw new Error(`Unexpected hyperscript child object: ${e}`)};for(const e of r.flat(1/0))n(e);return t};function re(r,t,n){return new b(t)}function oe(r,t,n){return[new b(t),new T(t)]}function H(r,t,n){return{...t,children:E(n)}}function se(r,t,n){return new T(t)}function ae(r,t,n){return E(n)}function ce(r,t,n){const e=n.find(c=>c instanceof b),o=n.find(c=>c instanceof T);if(!e||e.offset==null||e.path==null)throw new Error("The <selection> hyperscript tag must have an <anchor> tag as a child with `path` and `offset` attributes defined.");if(!o||o.offset==null||o.path==null)throw new Error("The <selection> hyperscript tag must have a <focus> tag as a child with `path` and `offset` attributes defined.");return{anchor:{offset:e.offset,path:e.path},focus:{offset:o.offset,path:o.path},...t}}function ie(r,t,n){const e=E(n);if(e.length>1)throw new Error("The <text> hyperscript tag must only contain a single node's worth of children.");let[o]=e;if(o==null&&(o={text:""}),!g.isText(o))throw new Error(`
    The <text> hyperscript tag can only contain text content as children.`);return w.delete(o),Object.assign(o,t),o}const le=r=>(t,n,e)=>{const o=[];let c;for(const d of e)S.isRange(d)?c=d:o.push(d);const m=E(o),f={},p=r();Object.assign(p,n),p.children=m;for(const[d,a]of D.texts(p)){const s=ee(d),i=ne(d);if(s!=null){const[l]=s;f.anchor={path:a,offset:l}}if(i!=null){const[l]=i;f.focus={path:a,offset:l}}}if(f.anchor&&!f.focus)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<anchor />`. For collapsed selections, use `<cursor />` instead.");if(!f.anchor&&f.focus)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<focus />`. For collapsed selections, use `<cursor />` instead.");return c!=null?p.selection=c:S.isRange(f)&&(p.selection=f),p},ue={anchor:re,cursor:oe,editor:le(O),element:H,focus:se,fragment:ae,selection:ce,text:ie},fe=(r={})=>{const{elements:t={}}=r,n=de(t),e={...ue,...n,...r.creators};return he(e)},he=r=>(n,e,...o)=>{const c=r[n];if(!c)throw new Error(`No hyperscript creator found for tag: <${n}>`);return e==null&&(e={}),B(e)||(o=[e].concat(o),e={}),o=o.filter(f=>!!f).flat(),c(n,e,o)},de=r=>{const t={};for(const n in r){const e=r[n];if(typeof e!="object")throw new Error(`Properties specified for a hyperscript shorthand should be an object, but for the custom element <${n}>  tag you passed: ${e}`);t[n]=(o,c,m)=>H("element",{...e,...c},m)}return t},N=fe(),pe=["src"],me=C({__name:"ImageElement",props:{element:{}},setup(r){const t=V(),n=G(),e=r;return(o,c)=>(R(),q("div",null,[z(o.$slots,"default"),W("img",{src:e.element.url,style:K([{display:"block","max-width":"100%","max-height":"20em"},{boxShadow:y(t)&&y(n)?"0 0 0 2px blue":"none"}])},null,12,pe)]))}}),Ee=C({__name:"index",setup(r){const t=["http:","https:","mailto:","tel:"],n={A:a=>({type:"link",url:a.getAttribute("href")}),BLOCKQUOTE:()=>({type:"block-quote"}),H1:()=>({type:"heading-one"}),H2:()=>({type:"heading-two"}),H3:()=>({type:"heading-three"}),H4:()=>({type:"heading-four"}),H5:()=>({type:"heading-five"}),H6:()=>({type:"heading-six"}),IMG:a=>({type:"image",url:a.getAttribute("src")}),LI:()=>({type:"list-item"}),OL:()=>({type:"numbered-list"}),P:()=>({type:"paragraph"}),PRE:()=>({type:"code-block"}),UL:()=>({type:"bulleted-list"})},e={CODE:()=>({code:!0}),DEL:()=>({strikethrough:!0}),EM:()=>({italic:!0}),I:()=>({italic:!0}),S:()=>({strikethrough:!0}),STRONG:()=>({bold:!0}),U:()=>({underline:!0})},o=a=>{if(a.nodeType===3)return a.textContent;if(a.nodeType!==1)return null;if(a.nodeName==="BR")return`
`;const s=a.nodeName;let i=a;s==="PRE"&&a.childNodes[0]&&a.childNodes[0].nodeName==="CODE"&&(i=a.childNodes[0]);let l=Array.from(i.childNodes).map(o).flat();if(l.length===0&&(l=[{text:""}]),a.nodeName==="BODY")return N("fragment",{},l);if(s in n){const h=n[s](a);return N("element",h,l)}if(s in e){const h=e[s]();return l.map(x=>N("text",h,x))}return l},c=a=>{const{insertData:s,isInline:i,isVoid:l}=a;return a.isInline=h=>h.type==="link"?!0:i(h),a.isVoid=h=>h.type==="image"?!0:l(h),a.insertData=h=>{const x=h.getData("text/html");if(x){const j=new DOMParser().parseFromString(x,"text/html"),v=o(j.body);$.insertFragment(a,v);return}s(h)},a},m=[{type:"paragraph",children:[{text:"By default, pasting content into a Slate editor will use the clipboard's "},{text:"'text/plain'",code:!0},{text:" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle "},{text:"'text/html'",code:!0},{text:" data. "}]},{type:"paragraph",children:[{text:"This is an example of doing exactly that!"}]},{type:"paragraph",children:[{text:"Try it out for yourself! Copy and paste some rendered HTML rich text content (not the source code) from another site into this editor and it's formatting should be preserved."}]}],f=a=>{const{attributes:s,children:i,element:l}=a;switch(l.type){default:return u("p",s,i);case"block-quote":return u("blockquote",s,i);case"code-block":return u("pre",null,u("code",s,i));case"bulleted-list":return u("ul",s,i);case"heading-one":return u("h1",s,i);case"heading-two":return u("h2",s,i);case"heading-three":return u("h3",s,i);case"heading-four":return u("h4",s,i);case"heading-five":return u("h5",s,i);case"heading-six":return u("h6",s,i);case"list-item":return u("li",s,i);case"numbered-list":return u("ol",s,i);case"link":return u("a",{...s,href:t.includes(l.url)?l.url:"about:blank"},i);case"image":return u(me,{element:l,...U(s)},i)}},p=a=>{const{attributes:s,children:i,leaf:l}=a;return"bold"in l?u("strong",s,i):"code"in l?u("code",s,i):"italic"in l?u("em",s,i):"underline"in l?u("u",s,i):u("span",s,i)},d=J(c(I(O())));return d.children=m,(a,s)=>(R(),Q(y(M),{editor:y(d),"render-element":f,"render-leaf":p},{default:X(()=>[Y(y(P),{placeholder:"Paste in some HTML...",spellcheck:""})]),_:1},8,["editor"]))}});export{Ee as default};
