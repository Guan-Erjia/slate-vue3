import{d as K,i as N,j as Y,f as j,e as b,w as k,h as i,o as _,a,k as x,c as w,b as y,l as C,v as B,m as T,F as R,u as V,s as v,n as D}from"./index-cO_khfoC.js";import{w as F,c as M,N as S,T as $,S as z,b as L}from"./editable-OBw7MXqz.js";import{w as P,a as U,Y as E,c as H,g as I,b as O}from"./index-FzwapiRn.js";import{T as W}from"./Toolbar-DItQkW23.js";import{_ as h,a as s}from"./BlockButton.vue_vue_type_script_setup_true_lang-HG5hzToY.js";import"./Button-Bz1s__lT.js";const X=K({__name:"YjsEditor",props:{sharedType:{}},setup(g){const p=[{type:"paragraph",children:[{text:""}]}],f=({attributes:e,children:t,element:c})=>{const o={...e,style:{"text-align":"align"in c?c.align||"left":""}};switch(c.type){case"block-quote":return i("blockquote",o,t);case"bulleted-list":return i("ul",o,t);case"heading-one":return i("h1",o,t);case"heading-two":return i("h2",o,t);case"heading-three":return i("h3",o,t);case"list-item":return i("li",o,t);case"numbered-list":return i("ol",o,t);default:return i("p",o,t)}},l=({leaf:e,attributes:t,children:c})=>{const o={};return"bold"in e&&(o.fontWeight="bold"),"italic"in e&&(o.fontStyle="italic"),"underline"in e&&(o.borderBottom="1px solid black"),"delete"in e&&(o.textDecoration="line-through"),i("code"in e?"code":"bold"in e?"strong":"span",{...t,style:o},c)},m=g,n=P(U(F(M()),m.sharedType));n.children=p;const{normalizeNode:d}=n;return n.normalizeNode=e=>{const[t]=e;if(S.isElement(t)&&t.children.length>0)return d(e);$.insertNodes(n,p[0],{at:[0]})},N(()=>{E.connect(n)}),Y(()=>{E.disconnect(n)}),(e,t)=>(_(),j(b(z),{editor:b(n),"render-element":f,"render-leaf":l},{default:k(()=>[a(W,null,{default:k(()=>[a(h,{format:"bold",icon:"format_bold"}),a(h,{format:"italic",icon:"format_italic"}),a(h,{format:"underline",icon:"format_underlined"}),a(h,{format:"code",icon:"code"}),a(s,{format:"heading-one",icon:"looks_one"}),a(s,{format:"heading-two",icon:"looks_two"}),a(s,{format:"block-quote",icon:"format_quote"}),a(s,{format:"numbered-list",icon:"format_list_numbered"}),a(s,{format:"bulleted-list",icon:"format_list_bulleted"}),a(s,{format:"left",icon:"format_align_left"}),a(s,{format:"center",icon:"format_align_center"}),a(s,{format:"right",icon:"format_align_right"}),a(s,{format:"justify",icon:"format_align_justify"})]),_:1}),a(b(L),{placeholder:"Enter some rich textâ€¦",spellcheck:""})]),_:1},8,["editor"]))}}),G={style:{display:"flex",width:"100%"}},J={key:1,style:{height:"300px"}},ne=K({__name:"index",setup(g){const p=V(),f=D(),l=x(p.query.publicApiKey||""),m=v(),n=v(),d=v(),e=x(!1),t=r=>e.value=r,c=()=>{try{const r=H({publicApiKey:l.value}).enterRoom("remote-simple"),u=I(r.room);u.on("sync",t),m.value=r,n.value=u,d.value=u.getYDoc().get("slate",O)}catch(r){alert(r),f.push({name:"remote-simple",query:{publicApiKey:""}})}},o=()=>{m.value?.leave(),n.value?.off("sync",t),m.value=void 0,n.value=void 0,d.value=void 0,e.value=!1,l.value=""};N(()=>{l.value&&c()}),Y(()=>{o()});const q=r=>{r.key==="Enter"&&(f.push({name:"remote-simple",query:{publicApiKey:l.value}}),c())};return(r,u)=>(_(),w(R,null,[u[1]||(u[1]=y("a",{href:"https://liveblocks.io/dashboard",style:{"margin-bottom":"12px",display:"block"},target:"_blank"}," ðŸ‘‰ Click it and get a publicApiKey from liveblocks",-1)),y("div",G,[C(y("input",{"onUpdate:modelValue":u[0]||(u[0]=A=>l.value=A),onKeyup:q,placeholder:"paste your liveblocks publicApiKey, and press Enter to connect",style:{width:"100%","margin-bottom":"10px"}},null,544),[[B,l.value]])]),d.value&&e.value?(_(),j(X,{key:0,sharedType:d.value},null,8,["sharedType"])):T("",!0),d.value&&!e.value?(_(),w("div",J,"Loading...")):T("",!0)],64))}});export{ne as default};
