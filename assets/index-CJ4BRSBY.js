import{w as q,c as F,S as J,T as r,a as f,E as p,R as D,b as Y,m as T}from"./editable-CteuoeWb.js";import{u as B}from"./use-inherit-ref-lmEEbD6_.js";import{i as H}from"./index-D2s9QVEm.js";import{T as j}from"./Toolbar-C0OhOQAT.js";import{B as L}from"./Button-ZsKZe3Ph.js";import{u as I}from"./use-selected-CVkp2faw.js";import{_ as G,c as g,o as x,t as Q,d as E,A as P,q as $,a,g as R,B as U,e as u,z as W,f as X,w as _,C as N,h as k}from"./index-C_5Oh6uc.js";import{w as Z}from"./with-history-g4SYTP6o.js";const ee={},te={contenteditable:!1,style:{"font-size":"0"}};function ne(h,i){return x(),g("span",te,Q(String.fromCodePoint(160)),1)}const m=G(ee,[["render",ne]]),oe=["href"],se=E({__name:"LinkComponent",props:{element:{}},setup(h){const i=["http:","https:","mailto:","tel:"],l=P(),c=I(),w=h,v=$(()=>{let d=null;try{d=new URL(w.element.url)}catch(b){console.error(b)}return d&&i.includes(d.protocol)?d.href:"about:blank"});return(d,b)=>(x(),g("a",U(u(l),{href:v.value,style:[{boxShadow:u(c)?"0 0 0 3px #ddd":""},{color:"#00e","text-decoration":"underline"}]}),[a(m),R(d.$slots,"default"),a(m)],16,oe))}}),ie=["data-playwright-selected"],re=E({__name:"BadgeComponent",setup(h){const i=I();return(l,c)=>(x(),g("span",{contenteditable:!1,style:W([{"background-color":"green",color:"white",padding:"2px 6px","border-radius":"2px","font-size":"0.9em"},{boxShadow:u(i)?"0 0 0 3px #ddd":""}]),"data-playwright-selected":u(i)},[a(m),R(l.$slots,"default"),a(m)],12,ie))}}),ae=E({__name:"ButtonComponent",setup(h){const i=c=>{c.preventDefault()},l=P();return(c,w)=>(x(),g("span",U({onClick:i,style:{margin:"0 0.1em","background-color":"#efefef",padding:"2px 6px",border:"1px solid #767676","border-radius":"2px"}},u(l)),[a(m),R(c.$slots,"default"),a(m)],16))}}),ye=E({__name:"index",setup(h){const i=$(()=>{const[e]=p.nodes(n,{match:t=>!p.isEditor(t)&&f.isElement(t)&&t.type==="link"});return!!e}),l=e=>{i.value&&r.unwrapNodes(n,{match:y=>!p.isEditor(y)&&f.isElement(y)&&y.type==="link"});const t=n.selection&&D.isCollapsed(n.selection),s={type:"link",url:e,children:t?[{text:e}]:[]};t?r.insertNodes(n,s):(r.wrapNodes(n,s,{split:!0}),r.collapse(n,{edge:"end"}))},c=$(()=>{const[e]=p.nodes(n,{match:t=>!p.isEditor(t)&&f.isElement(t)&&t.type==="button"});return!!e}),w=e=>{const{insertData:t,insertText:s,isInline:y,isElementReadOnly:V,isSelectable:M}=e;return e.isInline=o=>["link","button","badge"].includes(o.type)||y(o),e.isElementReadOnly=o=>o.type==="badge"||V(o),e.isSelectable=o=>o.type!=="badge"&&M(o),e.insertText=o=>{o&&H(o)?l(o):s(o)},e.insertData=o=>{const S=o.getData("text/plain");S&&H(S)?l(S):t(o)},e},v=[{type:"paragraph",children:[{text:"In addition to block nodes, you can create inline nodes. Here is a "},{type:"link",url:"https://en.wikipedia.org/wiki/Hypertext",children:[{text:"hyperlink"}]},{text:", and here is a more unusual inline: an "},{type:"button",children:[{text:"editable button"}]},{text:"! Here is a read-only inline: "},{type:"badge",children:[{text:"Approved"}]},{text:"."}]},{type:"paragraph",children:[{text:"There are two ways to add links. You can either add a link via the toolbar icon above, or if you want in on a little secret, copy a URL to your keyboard and paste it while a range of text is selected. "},{type:"link",url:"https://twitter.com/JustMissEmma/status/1448679899531726852",children:[{text:"Finally, here is our favorite dog video."}]},{text:""}]}],d=({attributes:e,children:t,element:s})=>{switch(s.type){case"link":return k(se,{...B(e),element:s},()=>t);case"button":return k(ae,{...B(e),element:s},()=>t);case"badge":return k(re,B(e),()=>t);default:return k("p",e,t)}},b=({attributes:e,children:t,leaf:s})=>k("span",{...e,style:{paddingLeft:s.text===""?"0.1px":""}},t),n=Z(w(q(F())));n.children=v;const A=e=>{if(n.selection&&D.isCollapsed(n.selection)){if(T.isKeyHotkey("left",e)){e.preventDefault(),r.move(n,{unit:"offset",reverse:!0});return}if(T.isKeyHotkey("right",e)){e.preventDefault(),r.move(n,{unit:"offset"});return}}},z=()=>{const e=window.prompt("Enter the URL of the link:");e&&n.selection&&l(e)},K=()=>{i.value&&r.unwrapNodes(n,{match:e=>!p.isEditor(e)&&f.isElement(e)&&e.type==="link"})},O=()=>{if(c.value)r.unwrapNodes(n,{match:e=>!p.isEditor(e)&&f.isElement(e)&&e.type==="button"});else if(n.selection){c.value&&r.unwrapNodes(n,{match:s=>!p.isEditor(s)&&f.isElement(s)&&s.type==="button"});const e=n.selection&&D.isCollapsed(n.selection),t={type:"button",children:e?[{text:"Edit me!"}]:[]};e?r.insertNodes(n,t):(r.wrapNodes(n,t,{split:!0}),r.collapse(n,{edge:"end"}))}},C=e=>{e.preventDefault()};return(e,t)=>(x(),X(u(J),{editor:u(n),"render-element":d,"render-leaf":b},{default:_(()=>[a(j,null,{default:_(()=>[a(L,{active:i.value,onClick:z,onPointerdown:C},{default:_(()=>t[0]||(t[0]=[N(" link ")])),_:1},8,["active"]),a(L,{active:i.value,onClick:K,onPointerdown:C},{default:_(()=>t[1]||(t[1]=[N(" link_off ")])),_:1},8,["active"]),a(L,{active:"",onClick:O,onPointerdown:C},{default:_(()=>t[2]||(t[2]=[N(" smart_button ")])),_:1})]),_:1}),a(u(Y),{placeholder:"Enter some text...",spellcheck:!1,onKeydown:A})]),_:1},8,["editor"]))}});export{ye as default};
