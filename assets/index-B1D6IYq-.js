import{d as R,A as Q,o as r,c as a,g as W,B as X,e as d,k as f,K as Y,i as Z,j as ee,b as t,C as u,l as c,M as O,F as y,x as H,N as b,m as S,t as h,f as ne,w as te,L as $,q as A,h as M,a as se}from"./index-cO_khfoC.js";import{f as x}from"./chunk-MVUZLZE2-BVB7fs3M.js";import{S as oe,w as le,c as ie,b as re}from"./editable-OBw7MXqz.js";import{u as ue}from"./use-inherit-ref-lmEEbD6_.js";import{w as ae}from"./with-history-Bo5zoz4N.js";import{u as de}from"./use-selected-9MwQlhdF.js";const ce=["aria-selected"],pe=R({__name:"heading",setup(F){const k=Q(),w=de();return(V,P)=>(r(),a("h1",X(d(k),{"aria-selected":d(w)}),[W(V.$slots,"default")],16,ce))}}),me={className:"performance-controls"},ke=["value"],he=["open"],ve={key:0},ge=["value"],fe={key:0,value:"chunk"},ye={key:0},be={key:0},xe=R({__name:"index",setup(F){const k=typeof window<"u"&&"PerformanceEventTiming"in window,w=typeof window<"u"&&"PerformanceLongAnimationFrameTiming"in window,V=[3,10,100,1e3],P=[2,1e3,2500,5e3,7500,1e4,15e3,2e4,25e3,3e4,4e4,5e4,1e5,2e5],l=typeof document>"u"?null:new URLSearchParams(document.location.search),D=(s,e)=>parseInt(l?.get(s)??"",10)||e,v=(s,e)=>{const n=l?.get(s);return n?n==="true":e},K=(s,e,n)=>{const i=l?.get(s);return i&&e.includes(i)?i:n},N={blocks:D("blocks",1e4),chunking:v("chunking",!0),chunkSize:D("chunk_size",1e3),chunkDivs:v("chunk_divs",!0),chunkOutlines:v("chunk_outlines",!1),contentVisibilityMode:K("content_visibility",["none","element","chunk"],"chunk"),showSelectedHeadings:v("selected_headings",!1)},G=s=>{l&&(l.set("blocks",s.blocks.toString()),l.set("chunking",s.chunking?"true":"false"),l.set("chunk_size",s.chunkSize.toString()),l.set("chunk_divs",s.chunkDivs?"true":"false"),l.set("chunk_outlines",s.chunkOutlines?"true":"false"),l.set("content_visibility",s.contentVisibilityMode),l.set("selected_headings",s.showSelectedHeadings?"true":"false"),history.replaceState({},"",`?${l.toString()}`))},p=[],C=s=>{if(p.length>=s)return p.slice(0,s);x.seed(1);for(let e=p.length;e<s;e++)if(e%100===0){const n={type:"heading-one",children:[{text:x.lorem.sentence()}]};p.push(n)}else{const n={type:"paragraph",children:[{text:x.lorem.paragraph()}]};p.push(n)}return p.slice()},T=s=>{const e=ae(le(ie()));return e.getChunkSize=n=>s.chunking&&n===e?s.chunkSize:null,e},E=f(!1),o=$(N),g=f(T(o));g.value.children=C(N.blocks);const U=f(!0),_=s=>{U.value=s.target.open};Y(()=>o,()=>{E.value=!0,G(o),setTimeout(()=>{E.value=!1,g.value=T(o),g.value.children=C(o.blocks)})},{deep:!0});const m=$([]),L=f(null),z=A(()=>m[0]??null),j=A(()=>m.length===10?Math.round(m.reduce((s,e)=>s+e)/10):null),B=new PerformanceObserver(s=>{s.getEntries().forEach(e=>{if(e.name==="keypress"){const n=Math.round(e.processingEnd-e.processingStart),i=m.slice(0,9);m.length=0,m.push(n,...i)}})}),I=new PerformanceObserver(s=>{s.getEntries().forEach(e=>{L.value=Math.round(e.duration)})});Z(()=>{B.observe({type:"event",durationThreshold:16}),I.observe({type:"long-animation-frame"})}),ee(()=>{B.disconnect(),I.disconnect()});const q=({attributes:s,children:e,element:n})=>{const i={contentVisibility:o.contentVisibilityMode==="element"?"auto":void 0};return n.type==="heading-one"?M(pe,{...ue(s),style:i,showSelectedHeadings:o.showSelectedHeadings},()=>e):M("p",{...s,style:i},e)},J=({attributes:s,children:e,lowest:n})=>{const i={contentVisibility:o.contentVisibilityMode==="chunk"&&n?"auto":void 0,border:o.chunkOutlines?"1px solid red":void 0,padding:o.chunkOutlines?20:void 0,marginBottom:o.chunkOutlines?20:void 0};return M("div",{...s,style:i},e)};return(s,e)=>(r(),a(y,null,[t("div",me,[t("p",null,[t("label",null,[e[7]||(e[7]=u(" Blocks: ",-1)),c(t("select",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.blocks=n)},[(r(),a(y,null,H(P,n=>t("option",{key:n,value:n},h(n.toString().replace(/(\d{3})$/,",$1")),9,ke)),64))],512),[[O,o.blocks]])])]),t("details",{open:U.value,onToggle:_},[e[21]||(e[21]=t("summary",null,"Configuration",-1)),t("p",null,[t("label",null,[c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>o.chunking=n),type:"checkbox"},null,512),[[b,o.chunking]]),e[8]||(e[8]=u(" Chunking enabled ",-1))])]),o.chunking?(r(),a(y,{key:0},[t("p",null,[t("label",null,[c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>o.chunkDivs=n),type:"checkbox"},null,512),[[b,o.chunkDivs]]),e[9]||(e[9]=u(" Render each chunk as a separate ",-1)),e[10]||(e[10]=t("code",null,"div",-1))])]),o.chunkDivs?(r(),a("p",ve,[t("label",null,[c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>o.chunkOutlines=n),type:"checkbox"},null,512),[[b,o.chunkOutlines]]),e[11]||(e[11]=u(" Outline each chunk ",-1))])])):S("",!0),t("p",null,[t("label",null,[e[12]||(e[12]=u(" Chunk size: ",-1)),c(t("select",{"onUpdate:modelValue":e[4]||(e[4]=n=>o.chunkSize=n)},[(r(),a(y,null,H(V,n=>t("option",{key:n,value:n},h(n),9,ge)),64))],512),[[O,o.chunkSize]])])])],64)):S("",!0),t("p",null,[t("label",null,[e[15]||(e[15]=u(" Set ",-1)),e[16]||(e[16]=t("code",null,"content-visibility: auto",-1)),e[17]||(e[17]=u(" on: ",-1)),c(t("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>o.contentVisibilityMode=n)},[e[13]||(e[13]=t("option",{value:"none"},"None",-1)),e[14]||(e[14]=t("option",{value:"element"},"Elements",-1)),o.chunking&&o.chunkDivs?(r(),a("option",fe," Lowest chunks ")):S("",!0)],512),[[O,o.contentVisibilityMode]])])]),t("p",null,[t("label",null,[c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>o.showSelectedHeadings=n),type:"checkbox"},null,512),[[b,o.showSelectedHeadings]]),e[18]||(e[18]=u(" Call ",-1)),e[19]||(e[19]=t("code",null,"useSelected",-1)),e[20]||(e[20]=u(" in each heading ",-1))])])],40,he),t("details",null,[e[22]||(e[22]=t("summary",null,"Statistics",-1)),t("p",null," Last keypress (ms): "+h(d(k)?z.value??"-":"Not supported"),1),t("p",null," Average of last 10 keypresses (ms): "+h(d(k)?j.value??"-":"Not supported"),1),t("p",null," Last long animation frame (ms): "+h(d(w)?L.value??"-":"Not supported"),1),d(k)&&z.value===null?(r(),a("p",ye," Events shorter than 16ms may not be detected. ")):S("",!0)])]),E.value?(r(),a("div",be,"Rendering")):(r(),ne(d(oe),{key:1,editor:g.value,"render-element":q,"render-chunk":o.chunkDivs?J:void 0},{default:te(()=>[se(d(re),{placeholder:"Enter some textâ€¦",spellcheck:"false"})]),_:1},8,["editor","render-chunk"]))],64))}});export{xe as default};
