import{w as q,c as F,S as J,T as a,N as u,R as S,b as Y,l as R,E as T}from"./editable-OBw7MXqz.js";import{u as N}from"./use-inherit-ref-lmEEbD6_.js";import{i as H}from"./index-BHu-i4Z0.js";import{T as j}from"./Toolbar-DItQkW23.js";import{B as D}from"./Button-Bz1s__lT.js";import{u as I}from"./use-selected-9MwQlhdF.js";import{_ as G,o as _,c as b,t as Q,d as g,A as P,a as i,g as $,B as U,e as p,q as L,z as W,f as X,w as h,C as B,h as y}from"./index-cO_khfoC.js";import{w as Z}from"./with-history-Bo5zoz4N.js";const ee={},te={contenteditable:!1,style:{"font-size":"0"}};function ne(m,r){return _(),b("span",te,Q(String.fromCodePoint(160)),1)}const f=G(ee,[["render",ne]]),oe=["href"],se=g({__name:"LinkComponent",props:{element:{}},setup(m){const r=["http:","https:","mailto:","tel:"],l=P(),c=I(),k=m,v=L(()=>{let d=null;try{d=new URL(k.element.url)}catch(x){console.error(x)}return d&&r.includes(d.protocol)?d.href:"about:blank"});return(d,x)=>(_(),b("a",U(p(l),{href:v.value,style:[{boxShadow:p(c)?"0 0 0 3px #ddd":""},{color:"#00e","text-decoration":"underline"}]}),[i(f),$(d.$slots,"default"),i(f)],16,oe))}}),re=["data-playwright-selected"],ae=g({__name:"BadgeComponent",setup(m){const r=I();return(l,c)=>(_(),b("span",{contenteditable:!1,style:W([{"background-color":"green",color:"white",padding:"2px 6px","border-radius":"2px","font-size":"0.9em"},{boxShadow:p(r)?"0 0 0 3px #ddd":""}]),"data-playwright-selected":p(r)},[i(f),$(l.$slots,"default"),i(f)],12,re))}}),ie=g({__name:"ButtonComponent",setup(m){const r=c=>{c.preventDefault()},l=P();return(c,k)=>(_(),b("span",U({onClick:r,style:{margin:"0 0.1em","background-color":"#efefef",padding:"2px 6px",border:"1px solid #767676","border-radius":"2px"}},p(l)),[i(f),$(c.$slots,"default"),i(f)],16))}}),ye=g({__name:"index",setup(m){const r=L(()=>{const[e]=T.nodes(n,{match:t=>u.isElement(t)&&t.type==="link"});return!!e}),l=e=>{r.value&&a.unwrapNodes(n,{match:w=>u.isElement(w)&&w.type==="link"});const t=n.selection&&S.isCollapsed(n.selection),s={type:"link",url:e,children:t?[{text:e}]:[]};t?a.insertNodes(n,s):(a.wrapNodes(n,s,{split:!0}),a.collapse(n,{edge:"end"}))},c=L(()=>{const[e]=T.nodes(n,{match:t=>u.isElement(t)&&t.type==="button"});return!!e}),k=e=>{const{insertData:t,insertText:s,isInline:w,isElementReadOnly:V,isSelectable:M}=e;return e.isInline=o=>["link","button","badge"].includes(o.type)||w(o),e.isElementReadOnly=o=>o.type==="badge"||V(o),e.isSelectable=o=>o.type!=="badge"&&M(o),e.insertText=o=>{o&&H(o)?l(o):s(o)},e.insertData=o=>{const E=o.getData("text/plain");E&&H(E)?l(E):t(o)},e},v=[{type:"paragraph",children:[{text:"In addition to block nodes, you can create inline nodes. Here is a "},{type:"link",url:"https://en.wikipedia.org/wiki/Hypertext",children:[{text:"hyperlink"}]},{text:", and here is a more unusual inline: an "},{type:"button",children:[{text:"editable button"}]},{text:"! Here is a read-only inline: "},{type:"badge",children:[{text:"Approved"}]},{text:"."}]},{type:"paragraph",children:[{text:"There are two ways to add links. You can either add a link via the toolbar icon above, or if you want in on a little secret, copy a URL to your keyboard and paste it while a range of text is selected. "},{type:"link",url:"https://twitter.com/JustMissEmma/status/1448679899531726852",children:[{text:"Finally, here is our favorite dog video."}]},{text:""}]}],d=({attributes:e,children:t,element:s})=>{switch(s.type){case"link":return y(se,{...N(e),element:s},()=>t);case"button":return y(ie,{...N(e),element:s},()=>t);case"badge":return y(ae,N(e),()=>t);default:return y("p",e,t)}},x=({attributes:e,children:t,leaf:s})=>y("span",{...e,style:{paddingLeft:s.text===""?"0.1px":""}},t),n=Z(k(q(F())));n.children=v;const A=e=>{if(n.selection&&S.isCollapsed(n.selection)){if(R.isKeyHotkey("left",e)){e.preventDefault(),a.move(n,{unit:"offset",reverse:!0});return}if(R.isKeyHotkey("right",e)){e.preventDefault(),a.move(n,{unit:"offset"});return}}},z=()=>{const e=window.prompt("Enter the URL of the link:");e&&n.selection&&l(e)},K=()=>{r.value&&a.unwrapNodes(n,{match:e=>u.isElement(e)&&e.type==="link"})},O=()=>{if(c.value)a.unwrapNodes(n,{match:e=>u.isElement(e)&&e.type==="button"});else if(n.selection){c.value&&a.unwrapNodes(n,{match:s=>u.isElement(s)&&s.type==="button"});const e=n.selection&&S.isCollapsed(n.selection),t={type:"button",children:e?[{text:"Edit me!"}]:[]};e?a.insertNodes(n,t):(a.wrapNodes(n,t,{split:!0}),a.collapse(n,{edge:"end"}))}},C=e=>{e.preventDefault()};return(e,t)=>(_(),X(p(J),{editor:p(n),"render-element":d,"render-leaf":x},{default:h(()=>[i(j,null,{default:h(()=>[i(D,{active:r.value,onClick:z,onPointerdown:C},{default:h(()=>[...t[0]||(t[0]=[B(" link ",-1)])]),_:1},8,["active"]),i(D,{active:r.value,onClick:K,onPointerdown:C},{default:h(()=>[...t[1]||(t[1]=[B(" link_off ",-1)])]),_:1},8,["active"]),i(D,{active:"",onClick:O,onPointerdown:C},{default:h(()=>[...t[2]||(t[2]=[B(" smart_button ",-1)])]),_:1})]),_:1}),i(p(Y),{placeholder:"Enter some text...",spellcheck:!1,onKeydown:A})]),_:1},8,["editor"]))}});export{ye as default};
